<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í‘¸ë¥¸í†¡ - ë¡œê·¸ì¸ ì—†ëŠ” ëœë¤ì±„íŒ…</title>
<link rel="icon" href="./puruntalk-icon-36x36.png" type="image/x-icon">
<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

<!-- SEO Meta Tags -->
<meta name="description" content="í‘¸ë¥¸í†¡ì€ ë¡œê·¸ì¸ ì—†ì´ ëˆ„êµ¬ì™€ë„ ì‰½ê²Œ ì‹œì‘í•  ìˆ˜ ìˆëŠ” ëœë¤ ì±„íŒ… ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ê³ , ìƒˆë¡œìš´ ë§Œë‚¨ì„ ì¦ê²¨ë³´ì„¸ìš”.">
<meta name="keywords" content="í‘¸ë¥¸í†¡, ëœë¤ì±„íŒ…, ìµëª…ì±„íŒ…, ì±„íŒ…ì•±, ëŒ€í™”í•˜ê¸°, ìƒˆë¡œìš´ ë§Œë‚¨">
<meta name="robots" content="index, follow">
<meta name="author" content="í‘¸ë¥¸í†¡">

<!-- Social Media Meta Tags -->
<meta property="og:title" content="í‘¸ë¥¸í†¡ - ë¡œê·¸ì¸ì—†ëŠ” ëœë¤ì±„íŒ…">
<meta property="og:description" content="ë¡œê·¸ì¸ ì—†ì´ ì‹œì‘í•˜ëŠ” ëœë¤ ì±„íŒ…. ìƒˆë¡œìš´ ì‚¬ëŒë“¤ê³¼ ìµëª…ìœ¼ë¡œ ëŒ€í™”í•˜ì„¸ìš”.">
<meta property="og:image" content="./puruntalk-social-image.png">
<meta property="og:url" content="https://puruntalk.me">
<meta name="twitter:card" content="summary_large_image">

<style>
  
  body {
    background-color: #f0f2f5;
  }
  #headerTitle {
    font-size: 24px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
    font-weight: bold;
    color: #2563EB; /* Tailwind CSSì˜ blue-500 ìƒ‰ìƒ ì½”ë“œ */
    text-align: center;
    padding: 10px 0;
  }
  #messages {
    background-color: white;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  }
  input, button {
    transition: all 0.2s ease-in-out;
  }
  button:hover {
    transform: translateY(-2px);
  }
</style>
</head>
<body class="flex flex-col items-center h-screen">
<div id="headerTitle">í‘¸ë¥¸í†¡</div>
<div class="w-full max-w-md sm:max-w-xl md:max-w-2xl lg:max-w-3xl xl:max-w-4xl px-4">
  <div id="nicknameScreen" class="p-4">
    <input id="nickname" type="text" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”" class="w-full p-3 rounded-lg border-2 border-gray-200 focus:outline-none focus:border-blue-500">
    <button id="startChat" class="mt-4 w-full bg-blue-500 text-white p-3 rounded-lg font-semibold hover:bg-blue-600 focus:outline-none">ëŒ€í™” ì‹œì‘í•˜ê¸°</button>
  </div>
  <div id="chatScreen" class="hidden flex flex-col p-4 h-full">
    <div id="messages" class="flex flex-col p-4 rounded-lg overflow-y-auto mb-4" style="height: 40vh;"></div>
    <input id="messageInput" type="text" placeholder="ë©”ì‹œì§€ ì…ë ¥..." class="p-3 rounded-lg border-2 border-gray-200 focus:outline-none focus:border-blue-500 mb-4">
    <button id="send" class="bg-blue-500 text-white p-3 rounded-lg font-semibold hover:bg-blue-600 focus:outline-none">ë³´ë‚´ê¸°</button>
    <button id="findNew" class="mt-2 bg-green-500 text-white p-3 rounded-lg font-semibold hover:bg-green-600 focus:outline-none">ë‹¤ë¥¸ ì‚¬ëŒê³¼ ëŒ€í™”í•˜ê¸°</button>
  </div>
</div>
<tenping class="adsbytenping" style="width:100%;max-width:768px;margin:0px auto;display:block;" tenping-ad-display-type="1LawCE8FqKOhetXZhMopsQ%3d%3d" tenping-ad-client="H1FwkQjubDbwXVoEF9c6ATojTxUFjiMkdVfmoK2r3kfytCWgAefcBzP8MXKqQ%2bts"></tenping>
<script async src="//ads.tenping.kr/scripts/adsbytenping.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const nicknameScreen = document.getElementById('nicknameScreen');
  const chatScreen = document.getElementById('chatScreen');
  const startChat = document.getElementById('startChat');
  const nicknameInput = document.getElementById('nickname');
  const messageInput = document.getElementById('messageInput');
  const sendButton = document.getElementById('send');
  const messagesDiv = document.getElementById('messages');
  const findNewButton = document.getElementById('findNew');

  startChat.addEventListener('click', () => {
    const nickname = nicknameInput.value.trim();
    if (nickname) {
      socket.emit('setNickname', nickname);
      nicknameScreen.classList.add('hidden');
      chatScreen.classList.remove('hidden');
      messagesDiv.innerHTML = `<div class="text-gray-600">ğŸ” ìƒˆë¡œìš´ ëŒ€í™” ìƒëŒ€ë¥¼ ì°¾ëŠ” ì¤‘...</div>`;
    }
  });

  socket.on('chatStart', (data) => {
    messagesDiv.innerHTML = `<div class="text-gray-600">ğŸ”— ${data.with}ë‹˜ê³¼ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. ëŒ€í™”ë¥¼ ì‹œì‘í•˜ì„¸ìš”!</div>`;
    scrollToBottom();
  });

  socket.on('message', (data) => {
    messagesDiv.innerHTML += `<div class="${data.from === 'ë‚˜' ? 'text-blue-500' : 'text-gray-800'}"><strong>${data.from}:</strong> ${data.msg}</div>`;
    scrollToBottom();
  });

  socket.on('partnerDisconnected', () => {
    messagesDiv.innerHTML += `<div class="text-red-500">âš ï¸ ìƒëŒ€ë°©ì´ ëŒ€í™”ì—ì„œ ë‚˜ê°”ìŠµë‹ˆë‹¤.</div>`;
    scrollToBottom();
  });

  function sanitizeInput(text) {
    return text.replace(/</g, "&lt;").replace(/>/g, "&gt;");
  }

  // ë©”ì‹œì§€ ì „ì†¡ í•¨ìˆ˜ ë‚´ì—ì„œ sanitizeInput í•¨ìˆ˜ ì‚¬ìš©
  sendButton.addEventListener('click', () => {
    let message = messageInput.value.trim();
    if (message) {
      message = sanitizeInput(message); // HTML íƒœê·¸ ì œê±°
      socket.emit('message', message);
      messagesDiv.innerHTML += `<div class="text-blue-500"><strong>ë‚˜:</strong> ${message}</div>`;
      messageInput.value = '';
      scrollToBottom();
    }
  });

  findNewButton.addEventListener('click', () => {
    socket.emit('findNew');
    messagesDiv.innerHTML = `<div class="text-gray-600">ğŸ” ìƒˆë¡œìš´ ëŒ€í™” ìƒëŒ€ë¥¼ ì°¾ëŠ” ì¤‘...</div>`;
    scrollToBottom();
  });

  function scrollToBottom() {
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }

  messageInput.addEventListener('keypress', (e) => {
    // ì—”í„°í‚¤ì˜ keyCodeëŠ” 13ì…ë‹ˆë‹¤.
    if (e.keyCode === 13) {
      e.preventDefault(); // í¼ ì œì¶œ ë“± ê¸°ë³¸ ì´ë²¤íŠ¸ë¥¼ ë°©ì§€í•©ë‹ˆë‹¤.
      sendButton.click(); // 'ë³´ë‚´ê¸°' ë²„íŠ¼ì˜ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.
    }
  });

</script>
</body>
</html>